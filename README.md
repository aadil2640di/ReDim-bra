# ReDim-bra
; Detect OS version and profile folders     $sDisk = EnvGet('systemdrive') ;Drive letter     If @OSVersion == 'WIN_8' Or @OSVersion == 'WIN_7' Or @OSVersion == 'WIN_VISTA' Or @OSVersion = 'WIN_2008' Then         $OS = 'NT6'         $profiledir = $sDisk &amp; '\Users'     ElseIf @OSVersion == 'WIN_XP' Then         $OS = 'NT5'         $profiledir = $sDisk &amp; '\Documents and Settings'     Else         MsgBox(48, 'Error', 'Wrong OS version')         Exit     EndIf          ; Set the user profile folders as $auserprofilefolders[] array     Global $auserprofilefolders[1]     $x = 0     $userprofilefolders = _FileListToArray($profiledir, '*', 2)     For $i = 1 To $userprofilefolders[0]         Select             Case $userprofilefolders[$i] = "All Users"             Case $userprofilefolders[$i] = "LocalService"             Case $userprofilefolders[$i] = "NetworkService"             Case $userprofilefolders[$i] = "Public"             Case Else                 $auserprofilefolders[$x] = $userprofilefolders[$i]                 $x += 1                 If $x >= UBound($auserprofilefolders) Then                     ReDim $auserprofilefolders[UBound($auserprofilefolders) + $x  + 1]                 EndIf
